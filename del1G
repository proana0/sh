try:	
	import requests,json,pyfiglet,termcolor
	##------------------##
	logo = pyfiglet.figlet_format('Ahmed Ramzy')
	mb = pyfiglet.figlet_format(" offerMB")
	descr = """
	 By: Ahmed Ramzy
	 Facebook: AhmedRamzy.me
	 """
	print(termcolor.colored(logo, color="red"), termcolor.colored(mb, color="blue"), termcolor.colored(descr, color="green"))
	print('=' * 50)
	## ------------------ End Descraption Script ------------------##
	number = '01050809324'
	pwd = 'A12345a@'
	#number = input(" [-1-] Enter Number Ana Vodafone: ")
#	pwd = input(" [-2-] Enter Password Ana Vodafone: ")
	with requests.Session() as req:
		## token
		def token():
			url = 'https://mobile.vodafone.com.eg/services/security/oauth/oauth/token'
			header = {
			'Accept': 'application/json, text/plain, */*',
			'api-host': 'token',
			'Connection': 'keep-alive',
			'Content-Type': 'application/x-www-form-urlencoded',
			'Host':'mobile.vodafone.com.eg',
			'Accept-Encoding': 'gzip',
			'User-Agent': 'okhttp/3.12.1'
			}
			formData = {
			'username': number,
			'password': pwd,
			'client_secret':'secret',
			'grant_type':'password',
			'client_id':'my-trusted-client'
			}
			sendData = req.post(url,headers = header, data = formData)
			access_token = sendData.json()['access_token']
			return access_token
		##------ End token -------##

		## Offer 400 MB
		def offer400MB():
			url = 'https://mobile.vodafone.com.eg/services/dxl/pom/productOrder'
			header = {
			'api-host': 'ProductOrderingManagementHost',
			'useCase': 'MIProfile',
			'Accept': 'application/json',
			'access-token': token(),
			'msisdn': number,
			'Accept-Language': 'ar',
			'Content-Type': 'application/json; charset=UTF-8',
			'Host': 'mobile.vodafone.com.eg',
			'Connection': 'Keep-Alive',
			'Accept-Encoding': 'gzip',
			'User-Agent': 'okhttp/3.12.1'
			}
			payload = {"channel":{"name":"MobileApp"},"characteristic":[],
			"orderItem":[{"action":"delete","product":{"characteristic":[{"name":"LangId",
			"value":"ar"},{"name":"ExecutionType","value":"Sync"}],"id":"120",
			"relatedParty":[{"id":f"{number}","name":"MSISDN","role":"Subscriber"}],
			"@type":"MI"}}],"@type":"MIProfile"}

			sendData = req.post(url,headers = header, data = json.dumps(payload))
			state = sendData.json()
			if str(state).find("state") != -1:
				print('>'*50)
				print(" __ offer discount MB added successfully __")
				print('>'*50)
			else:
				print(" [False] An error occurred")	
		offer400MB()
except KeyError:
	print(" [False] Username or Password.")